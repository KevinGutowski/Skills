<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Skill — Skill Forge</title>
  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Sora:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
  <div class="skill-page">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="back-link">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span>All Skills</span>
        </a>
      </div>
      
      <div class="skill-info">
        <span class="skill-badge" id="collectionBadge" style="display: none;"></span>
        <h1 class="skill-title" id="skillTitle">Loading...</h1>
      </div>
      
      <div class="sidebar-section">
        <div class="section-header">
          <span class="section-label">Files</span>
          <button class="btn-add-file" id="btnAddFile" title="Add new file">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 3V13M3 8H13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
        </div>
        <div class="file-tree" id="fileTree">
          <!-- File tree will be rendered here -->
        </div>
      </div>
      
      <div class="sidebar-section sidebar-meta">
        <div class="meta-block">
          <span class="meta-label">Description</span>
          <p class="meta-value" id="skillDescription">-</p>
        </div>
        <div class="meta-block" id="depsBlock" style="display: none;">
          <span class="meta-label">Dependencies</span>
          <p class="meta-value" id="skillDependencies">-</p>
        </div>
      </div>
      
      <div class="sidebar-actions">
        <button class="btn-action" id="btnEditMeta">
          <span class="action-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g class="nc-icon-wrapper" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="currentColor"><path d="M13.953 7.57801L15.062 6.46901C15.648 5.88301 15.648 4.93301 15.062 4.34801L13.653 2.93901C13.067 2.35301 12.117 2.35301 11.532 2.93901L10.423 4.04801L13.953 7.57801Z" fill="currentColor" fill-opacity="0.3" data-color="color-2" data-stroke="none" stroke="none"></path> <path d="M13.953 7.57801L15.062 6.46901C15.648 5.88301 15.648 4.93301 15.062 4.34801L13.653 2.93901C13.067 2.35301 12.117 2.35301 11.532 2.93901L10.423 4.04801L13.953 7.57801Z"></path> <path d="M8.6544 5.81464L4.147 10.322C3.897 10.572 3.718 10.884 3.627 11.226L2.5 15.499L6.773 14.372C7.115 14.282 7.427 14.102 7.677 13.852L12.1844 9.34463"></path> <path d="M10.4044 7.56464L6.26501 11.704"></path></g></svg>
          </span>
          Edit Metadata
        </button>
        <button class="btn-action" id="btnDownload">
          <span class="action-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g class="nc-icon-wrapper" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="currentColor"><path d="M12.25 3H13.75C14.855 3 15.75 3.895 15.75 5V12.75C15.75 13.855 14.855 14.75 13.75 14.75H4.25C3.145 14.75 2.25 13.855 2.25 12.75V5C2.25 3.895 3.145 3 4.25 3H5.75" fill="currentColor" fill-opacity="0.3" data-color="color-2" data-stroke="none" stroke="none"></path> <path d="M12.25 3.25H13.75C14.855 3.25 15.75 4.145 15.75 5.25V12.75C15.75 13.855 14.855 14.75 13.75 14.75H4.25C3.145 14.75 2.25 13.855 2.25 12.75V5.25C2.25 4.145 3.145 3.25 4.25 3.25H5.75"></path> <path d="M12 8.75L9 11.75L6 8.75"></path> <path d="M9 11.75V3.25"></path></g></svg>
          </span>
          Download ZIP
        </button>
        <button class="btn-action btn-danger" id="btnDeleteSkill">
          <span class="action-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g class="nc-icon-wrapper" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="currentColor"><path opacity="0.3" d="M13.605 4.75L13.099 14.35C13.043 15.4201 12.165 16.25 11.102 16.25H6.89703C5.83303 16.25 4.95602 15.42 4.90002 14.35L4.39404 4.75" fill="currentColor" data-color="color-2" data-stroke="none" stroke="none"></path> <path d="M2.75 4.75H15.25"></path> <path d="M6.75 4.75V2.75C6.75 2.2 7.198 1.75 7.75 1.75H10.25C10.802 1.75 11.25 2.2 11.25 2.75V4.75"></path> <path d="M13.8557 4.75L13.35 14.35C13.294 15.4201 12.416 16.25 11.353 16.25H6.64798C5.58398 16.25 4.70697 15.42 4.65097 14.35L4.14526 4.75"></path> <path d="M7.32495 8L7.59213 13.25"></path> <path d="M10.675 8L10.4078 13.25"></path></g></svg>
          </span>
          Delete Skill
        </button>
      </div>
    </aside>
    
    <!-- Main Content -->
    <main class="skill-main">
      <div class="editor-header">
        <div class="editor-tabs">
          <span class="editor-file-name" id="currentFileName">Select a file</span>
        </div>
        <div class="editor-actions" id="editorActions" style="display: none;">
          <div class="view-toggle">
            <button class="toggle-btn active" data-view="edit" id="btnViewEdit">Edit</button>
            <button class="toggle-btn" data-view="preview" id="btnViewPreview">Preview</button>
          </div>
          <button class="btn-save" id="btnSaveFile">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M13 14H3C2.44772 14 2 13.5523 2 13V3C2 2.44772 2.44772 2 3 2H10L14 6V13C14 13.5523 13.5523 14 13 14Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M10 2V6H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Save
          </button>
        </div>
      </div>
      
      <div class="editor-content">
        <div class="empty-editor" id="emptyEditor">
          <div class="empty-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 18 18"><g class="nc-icon-wrapper" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" stroke="currentColor"><path d="M4.25 6.75H13.75C14.855 6.75 15.75 7.645 15.75 8.75V13.25C15.75 14.355 14.855 15.25 13.75 15.25H4.25C3.145 15.25 2.25 14.355 2.25 13.25V8.75C2.25 7.645 3.145 6.75 4.25 6.75Z" fill="currentColor" fill-opacity="0.3" data-color="color-2" data-stroke="none" stroke="none"></path> <path d="M2.25 8.75V4.75C2.25 3.645 3.145 2.75 4.25 2.75H6.201C6.808 2.75 7.381 3.025 7.761 3.498L8.364 4.25H13.75C14.855 4.25 15.75 5.145 15.75 6.25V9.094"></path> <path d="M4.25 6.75H13.75C14.855 6.75 15.75 7.645 15.75 8.75V13.25C15.75 14.355 14.855 15.25 13.75 15.25H4.25C3.145 15.25 2.25 14.355 2.25 13.25V8.75C2.25 7.645 3.145 6.75 4.25 6.75Z"></path></g></svg>
          </div>
          <h2>Select a file to view or edit</h2>
          <p>Choose a file from the sidebar or create a new one</p>
        </div>
        
        <textarea class="code-editor" id="codeEditor" style="display: none;" spellcheck="false"></textarea>
        
        <div class="markdown-preview" id="markdownPreview" style="display: none;"></div>
      </div>
    </main>
  </div>

  <!-- Edit Metadata Modal -->
  <div class="modal-overlay" id="editModalOverlay">
    <div class="modal">
      <div class="modal-header">
        <h2>Edit Skill Metadata</h2>
        <button class="modal-close" id="editModalClose">×</button>
      </div>
      
      <form class="skill-form" id="editForm">
        <div class="form-group">
          <label for="editName">
            Name
            <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="editName" 
            maxlength="64"
            pattern="[a-z0-9\-]+"
            required
          >
          <p class="field-hint">Lowercase letters, numbers, and hyphens only</p>
        </div>

        <div class="form-group">
          <label for="editDescription">
            Description
            <span class="required">*</span>
          </label>
          <textarea 
            id="editDescription" 
            maxlength="1024"
            rows="3"
            required
          ></textarea>
          <p class="field-hint">Claude uses this to determine when to invoke your Skill</p>
        </div>

        <div class="form-group">
          <label for="editDependencies">
            Dependencies
            <span class="optional">(optional)</span>
          </label>
          <input 
            type="text" 
            id="editDependencies" 
            placeholder="e.g., python>=3.8, pandas>=1.5.0"
          >
        </div>
        
        <div class="form-group">
          <label for="editCollection">
            Collection
            <span class="optional">(optional)</span>
          </label>
          <select id="editCollection">
            <option value="">No Collection</option>
          </select>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-secondary" id="btnEditCancel">Cancel</button>
          <button type="submit" class="btn-primary">Save Changes</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Add File Modal -->
  <div class="modal-overlay" id="addFileModalOverlay">
    <div class="modal modal-small">
      <div class="modal-header">
        <h2>Add New File</h2>
        <button class="modal-close" id="addFileModalClose">×</button>
      </div>
      
      <form class="skill-form" id="addFileForm">
        <div class="form-group">
          <label for="newFileName">
            File Name
            <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="newFileName" 
            placeholder="e.g., REFERENCE.md, examples/usage.py"
            required
          >
          <p class="field-hint">Include extension. Use / for folders.</p>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-secondary" id="btnAddFileCancel">Cancel</button>
          <button type="submit" class="btn-primary">Create File</button>
        </div>
      </form>
    </div>
  </div>

  <script src="skill.js"></script>
</body>
</html>
